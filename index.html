<!doctype html>
<html lang="pt-BR">
<head>
<meta charset="utf-8">
<title>Ranking Estrelas Guia</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<style>
:root{
  --bg1:#070A12;
  --bg2:#0B1024;
  --stroke:#ffffff18;
  --txt:#eaf0ff;
  --muted:#a9b5e6;
  --gold:#ffd166;
  --silver:#cbd5e1;
  --bronze:#fb7185;
  --accent:#22d3ee;
}

*{box-sizing:border-box}
body{
  margin:0;
  color:var(--txt);
  font-family:system-ui,Segoe UI,Roboto,Arial;
  background:
    radial-gradient(1000px 600px at 20% 10%, #2b1a5a55, transparent 60%),
    radial-gradient(900px 600px at 80% 30%, #0088aa44, transparent 60%),
    linear-gradient(180deg, var(--bg1), var(--bg2));
}

.wrap{
  max-width:1000px;
  margin:auto;
  padding:24px;
}

header{ margin-bottom:18px; }

.main-title{
  font-size: clamp(26px, 4.2vw, 40px);
  font-weight:900;
  letter-spacing:1px;
  margin:0;
  text-transform:uppercase;
}

.sub-title{
  font-size:16px;
  font-weight:800;
  color:var(--accent);
  margin-top:6px;
}

.tabbar{
  display:flex;
  gap:12px;
  margin:14px 0 0;
  flex-wrap:wrap;
}

.tab{
  padding:10px 14px;
  border-radius:14px;
  border:1px solid var(--stroke);
  background:#0b1130cc;
  color:var(--txt);
  font-weight:800;
  cursor:pointer;
}

.tab.active{
  border-color:var(--accent);
  box-shadow:0 0 18px #22d3ee55;
}

.board{
  border:1px solid var(--stroke);
  border-radius:20px;
  background:#0c1433cc;
  padding:16px;
}

/* TOP 3 - DESKTOP (2-1-3) */
.top3{
  display:grid;
  grid-template-columns:1fr 1.2fr 1fr;
  gap:14px;
  align-items:end;
}

/* escudo base */
.shield{
  clip-path:polygon(50% 0%,90% 15%,90% 65%,50% 100%,10% 65%,10% 15%);
  text-align:center;
  padding:22px 14px 24px;
  transition:transform .25s ease, opacity .25s ease;
  animation:fadeUp .35s ease;
  min-height:168px;
  position:relative;
  overflow:hidden;
}

@keyframes fadeUp{
  from{opacity:0;transform:translateY(12px)}
  to{opacity:1;transform:none}
}

/* podium positions */
.shield.p1{
  background:linear-gradient(180deg,var(--gold),#b45309);
  color:#2b1900;
  transform: translateY(-18px) scale(1.04);
  box-shadow:0 0 40px #ffd166aa;
  z-index:2;
}

.shield.p2{
  background:linear-gradient(180deg,var(--silver),#64748b);
  color:#0f172a;
  transform: translateY(10px);
  z-index:1;
}

.shield.p3{
  background:linear-gradient(180deg,var(--bronze),#7f1d1d);
  color:#2b0000;
  transform: translateY(10px);
  z-index:1;
}

/* textos do topo */
.rank{
  font-size:20px;
  font-weight:900;
  margin-top:6px;
}

.name{
  font-size:17px;
  font-weight:900;
  text-transform:uppercase;
  margin-top:8px;
  line-height:1.2;
}

.score{
  font-size:22px;
  font-weight:900;
  margin-top:10px;
}

.score span{
  display:block;
  font-size:12px;
  opacity:.85;
}

/* ===== CAMPE√ÉO: brilho pulsante + shine + coroa flutuando ===== */

/* glow pulsante */
@keyframes champGlow{
  0%,100% { box-shadow: 0 0 26px #ffd16666, 0 0 55px #ffd16644; }
  50%     { box-shadow: 0 0 40px #ffd166aa, 0 0 85px #ffd16666; }
}

/* brilho diagonal passando */
@keyframes shineSweep{
  0%   { transform: translateX(-140%) rotate(18deg); opacity: .0; }
  10%  { opacity: .35; }
  45%  { opacity: .20; }
  70%  { opacity: .0; }
  100% { transform: translateX(140%) rotate(18deg); opacity: 0; }
}

/* coroa flutuando */
@keyframes crownFloat{
  0%,100%{ transform: translateY(0); }
  50%{ transform: translateY(-4px); }
}

.champion{
  animation: champGlow 2.3s ease-in-out infinite;
  outline: 2px solid #22d3ee33;
  outline-offset: 3px;
}

.champion::before{
  content:"";
  position:absolute;
  inset:-40px;
  background: linear-gradient(90deg,
    transparent 0%,
    rgba(255,255,255,.35) 40%,
    rgba(255,255,255,.12) 55%,
    transparent 70%
  );
  width:60%;
  height:200%;
  top:-50%;
  left:-60%;
  filter: blur(1px);
  animation: shineSweep 3.3s ease-in-out infinite;
  pointer-events:none;
}

.crown{
  font-size:26px;
  line-height:1;
  display:inline-block;
  margin-top:2px;
  animation: crownFloat 1.8s ease-in-out infinite;
}

/* LISTA */
.list{ margin-top:18px; }

.row{
  display:grid;
  grid-template-columns:70px 1fr 120px;
  padding:10px 12px;
  border-radius:12px;
  margin-bottom:6px;
  gap:10px;
}

.row:nth-child(odd){ background:#0b1130aa; }

.pos{
  font-weight:900;
  color:var(--muted);
}

.who{
  font-weight:800;
  white-space:nowrap;
  overflow:hidden;
  text-overflow:ellipsis;
}

.val{
  text-align:right;
  font-weight:900;
}

/* ===== MOBILE: p√≥dio 1 em cima, 2/3 embaixo lado a lado ===== */
@media (max-width: 560px){
  .wrap{ padding:16px; }
  .board{ padding:14px; }

  .top3{
    grid-template-columns:1fr 1fr;
    grid-template-areas:
      "first first"
      "second third";
    gap:12px;
    align-items:stretch;
  }

  /* o JS renderiza 2-1-3, ent√£o vamos mapear pela classe */
  .top3 .p1{ grid-area:first; }
  .top3 .p2{ grid-area:second; }
  .top3 .p3{ grid-area:third; }

  .shield{
    min-height: 150px;
    padding:18px 12px 20px;
    transform:none !important; /* remove empurr√µes no mobile */
  }

  .shield.p1{
    transform:none !important;
    scale: 1; /* maior j√° pelo espa√ßo */
  }

  .rank{ font-size:18px; }
  .name{ font-size:16px; }
  .score{ font-size:20px; }

  .row{ grid-template-columns:62px 1fr 90px; }
}
</style>
</head>

<body>
<div class="wrap">
  <header>
    <h1 class="main-title">‚≠ê Ranking Estrelas Guia</h1>
    <div id="pageTitle" class="sub-title">Estrelas Guia</div>

    <div class="tabbar">
      <button class="tab active" data-key="estrelas_guia">Estrelas Guia</button>
      <button class="tab" data-key="guiados_estrelas">Guiados / Estrelas</button>
      <button class="tab" data-key="guiados">Guiados</button>
    </div>
  </header>

  <section class="board">
    <div class="top3" id="top3"></div>
    <div class="list" id="list"></div>
  </section>
</div>

<audio id="clickSound" preload="auto">
  <source src="https://assets.mixkit.co/sfx/preview/mixkit-game-click-1114.mp3">
</audio>

<script>
const DATA_FILE = "dados.txt";

const tabs = [
  { key: "estrelas_guia", label: "Estrelas Guia" },
  { key: "guiados_estrelas", label: "Guiados / Estrelas" },
  { key: "guiados", label: "Guiados" }
];

let data = {};
let active = "estrelas_guia";

const top3El = document.getElementById("top3");
const listEl = document.getElementById("list");
const pageTitle = document.getElementById("pageTitle");
const sound = document.getElementById("clickSound");

/**
 * Parser robusto para seu formato colado no Bloco de Notas.
 * Em cada linha ele tenta achar at√© 3 ocorr√™ncias do padr√£o:
 *   "1¬∫ NOME 16"  (repete lado a lado)
 */
function parse(text){
  const out = { estrelas_guia:[], guiados_estrelas:[], guiados:[] };
  const re = /(\d+\s*¬∫)\s+([A-Z√Ä-√ö0-9.\-\/ ]+?)\s+(\d+(?:[.,]\d+)?)\b/gmi;

  text.split(/\r?\n/).forEach(line=>{
    const upper = line.toUpperCase();
    if (
      upper.includes("ESTRELAS") ||
      upper.includes("GUIADOS/") ||
      upper.trim() === "GUIADOS" ||
      upper.includes("VENDEDOR") ||
      upper.includes("VIDAS")
    ) return;

    const matches = [];
    let m;
    while ((m = re.exec(line)) !== null){
      const name = (m[2] || "").trim().replace(/\s{2,}/g," ");
      const score = Number(String(m[3]).replace(",", "."));
      if (!name || !Number.isFinite(score)) continue;

      matches.push({
        name,
        score,
        pos: (m[1] || "").replace(/\s+/g,"")
      });
    }

    if (matches[0]) out.estrelas_guia.push(matches[0]);
    if (matches[1]) out.guiados_estrelas.push(matches[1]);
    if (matches[2]) out.guiados.push(matches[2]);
  });

  Object.keys(out).forEach(k=>{
    out[k].sort((a,b) => (b.score - a.score) || a.name.localeCompare(b.name, "pt-BR"));
  });

  return out;
}

function escapeHtml(s){
  return String(s).replace(/[&<>"']/g, m => ({
    "&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#039;"
  }[m]));
}

function render(){
  const items = data[active] || [];
  pageTitle.textContent = (tabs.find(t=>t.key===active)?.label) || "Ranking";

  const top = items.slice(0,3);

  // ordem visual: 2¬∫ (esq), 1¬∫ (meio), 3¬∫ (dir)
  const visual = [
    { item: top[1], place: 2 },
    { item: top[0], place: 1 },
    { item: top[2], place: 3 }
  ].filter(v => v.item);

  top3El.innerHTML = visual.map(v => `
    <div class="shield p${v.place} ${v.place===1 ? "champion" : ""}">
      ${v.place===1 ? '<div class="crown">üëë</div>' : ''}
      <div class="rank">${v.place}¬∫</div>
      <div class="name">${escapeHtml(v.item.name)}</div>
      <div class="score">${v.item.score}<span>vidas</span></div>
    </div>
  `).join("");

  // lista do 4¬∫ em diante
  listEl.innerHTML = items.slice(3).map((i,idx)=>`
    <div class="row">
      <div class="pos">${idx+4}¬∫</div>
      <div class="who">${escapeHtml(i.name)}</div>
      <div class="val">${i.score}</div>
    </div>
  `).join("");
}

async function load(){
  const t = await fetch(DATA_FILE + "?v=" + Date.now()).then(r => r.text());
  data = parse(t);
  render();
}

document.querySelectorAll(".tab").forEach(b=>{
  b.onclick = () => {
    active = b.dataset.key;
    document.querySelectorAll(".tab").forEach(x=>x.classList.remove("active"));
    b.classList.add("active");

    // som discreto
    try{
      sound.volume = 0.25;
      sound.currentTime = 0;
      sound.play();
    }catch(e){}

    render();
  };
});

load();
</script>
</body>
</html>

