<!doctype html>
<html lang="pt-BR">
<head>
<meta charset="utf-8">
<title>Ranking Estrelas Guia</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<style>
:root{
  --bg1:#070A12;
  --bg2:#0B1024;
  --stroke:#ffffff18;
  --txt:#eaf0ff;
  --muted:#a9b5e6;
  --gold:#ffd166;
  --silver:#cbd5e1;
  --bronze:#fb7185;
  --accent:#22d3ee;
}

*{box-sizing:border-box}
html,body{height:100%}
body{
  margin:0;
  color:var(--txt);
  font-family:system-ui,Segoe UI,Roboto,Arial;
  background:
    radial-gradient(1200px 700px at 20% 10%, #2b1a5a55, transparent 60%),
    radial-gradient(1100px 700px at 80% 30%, #0088aa44, transparent 60%),
    linear-gradient(180deg, var(--bg1), var(--bg2));
}

.wrap{
  max-width:1100px;
  margin:auto;
  padding:24px;
}

header{ margin-bottom:14px; }

.main-title{
  font-size: clamp(26px, 4vw, 40px);
  font-weight:900;
  text-transform:uppercase;
  margin:0;
}

.sub-title{
  font-size:16px;
  font-weight:800;
  color:var(--accent);
  margin-top:4px;
}

.tabbar{
  display:flex;
  gap:10px;
  margin-top:12px;
  flex-wrap:wrap;
}

.tab{
  padding:10px 14px;
  border-radius:14px;
  border:1px solid var(--stroke);
  background:#0b1130cc;
  color:var(--txt);
  font-weight:800;
  cursor:pointer;
}
.tab.active{
  border-color:var(--accent);
  box-shadow:0 0 18px #22d3ee55;
}

.board{
  border:1px solid var(--stroke);
  border-radius:20px;
  background:#0c1433cc;
  padding:16px;
}

/* ====== LAYOUT 2 COLUNAS ====== */
.content{
  display:grid;
  grid-template-columns: 1fr 1fr;
  gap:14px;
  align-items:stretch;
  margin-top: 10px;
}

.panel{
  border:1px solid var(--stroke);
  border-radius:18px;
  background:#0b1130aa;
  padding:14px;
  overflow:hidden;
}

.panel-title{
  font-size:13px;
  font-weight:900;
  color:var(--muted);
  letter-spacing:.6px;
  text-transform:uppercase;
  margin:0 0 10px;
  display:flex;
  align-items:center;
  gap:8px;
}

/* TOP 3 */
.top3{
  display:grid;
  grid-template-columns: 1fr 1fr;
  grid-template-areas:
    "first first"
    "second third";
  gap:12px;
  align-items:stretch;
}
.top3 .p1{ grid-area:first; justify-self:center; } /* centraliza */
.top3 .p2{ grid-area:second; }
.top3 .p3{ grid-area:third; }

.shield{
  clip-path:polygon(50% 0%,90% 15%,90% 65%,50% 100%,10% 65%,10% 15%);
  text-align:center;
  padding:18px 12px 20px;
  min-height:160px;
  position:relative;
  overflow:hidden;
  animation:fadeUp .35s ease;
  isolation:isolate;
}

/* ‚úÖ evita deforma√ß√£o: limita largura m√°xima do escudo, inclusive do 1¬∫ */
.shield{
  width:100%;
  max-width: 420px;
}

/* ‚úÖ 1¬∫ fica maior SEM esticar (scale + altura), mantendo o formato */
.shield.p1{
  max-width: 440px;
  min-height: 190px;
  transform: scale(1.05);
}

@keyframes fadeUp{
  from{opacity:0;transform:translateY(10px)}
  to{opacity:1;transform:none}
}

/* CORES */
.shield.p1{
  background:linear-gradient(180deg,var(--gold),#b45309);
  color:#2b1900;
  z-index:2;
}
.shield.p2{
  background:linear-gradient(180deg,var(--silver),#64748b);
  color:#0f172a;
}
.shield.p3{
  background:linear-gradient(180deg,var(--bronze),#7f1d1d);
  color:#2b0000;
}

/* üî¢ N√∫mero gigante no fundo (watermark) */
.bg-rank{
  position:absolute;
  inset:0;
  display:flex;
  align-items:center;          /* centraliza na vertical */
  justify-content:flex-start;  /* cola na esquerda */
  padding-left:18px;           /* dist√¢ncia da borda interna */
  font-weight:1000;
  font-size: clamp(90px, 11vw, 160px);
  opacity:.14;
  letter-spacing:-8px;
  z-index:0;
  user-select:none;
  pointer-events:none;
  mix-blend-mode: soft-light;
}

/* garante que o conte√∫do fique na frente do n√∫mero */
.front{
  position:relative;
  z-index:2;
}

.rank{font-size:18px;font-weight:900;margin-top:2px}
.name{font-size:16px;font-weight:900;text-transform:uppercase;margin-top:6px;line-height:1.15}
.score{font-size:20px;font-weight:900;margin-top:8px}
.score span{display:block;font-size:12px;opacity:.85}

/* Campe√£o ‚Äì luz forte */
@keyframes champGlow{
  0%,100%{box-shadow:0 0 45px #ffd166cc,0 0 120px #ffd16688}
  50%{box-shadow:0 0 70px #ffd166ff,0 0 160px #ffd166aa}
}
.champion{ animation:champGlow 2.2s ease-in-out infinite; }
.champion::after{
  content:"";
  position:absolute;
  inset:-18px;
  background:radial-gradient(circle,#ffd16688 0%,transparent 70%);
  filter:blur(14px);
  z-index:-1;
}
@keyframes crownFloat{
  0%,100%{transform:translateY(0)}
  50%{transform:translateY(-5px)}
}
.crown{ font-size:24px; animation:crownFloat 1.8s ease-in-out infinite; }

/* LISTA DIREITA */
.list{
  display:flex;
  flex-direction:column;
  gap:8px;
}

.row{
  display:grid;
  grid-template-columns: 60px 1fr 70px;
  align-items:center;
  gap:10px;
  padding:10px 12px;
  border-radius:14px;
  background:#0a1028aa;
  border:1px solid transparent;
}
.row:nth-child(odd){ background:#0b1130aa; }
.row:hover{ border-color: var(--stroke); }

.pos{
  font-weight:900;
  color:var(--muted);
}
.who{
  font-weight:850;
  white-space:nowrap;
  overflow:hidden;
  text-overflow:ellipsis;
}
.val{
  text-align:right;
  font-weight:900;
}

/* MOBILE: empilha */
@media (max-width: 820px){
  .content{ grid-template-columns: 1fr; }
  .shield{ max-width: none; }
  .shield.p1{ transform:none; }
  .bg-rank{ font-size: 110px; }
}

/* MODO TV */
body.tv .wrap{
  max-width:none;
  width:100vw;
  min-height:100vh;
  padding: 2vh 3vw;
}
body.tv .board{ border-radius:26px; padding:18px; }
body.tv .main-title{ font-size: clamp(38px, 3.2vw, 64px); }
body.tv .sub-title{ font-size: clamp(18px, 1.2vw, 26px); }
body.tv .tab{ padding:14px 18px; font-size:18px; }

body.tv .content{ gap:18px; margin-top: 12px; }
body.tv .panel{ padding:18px; border-radius:22px; }
body.tv .panel-title{ font-size: 15px; margin-bottom: 12px; }

body.tv .shield{
  min-height: 250px;
  padding: 32px 18px 36px;
  max-width: 520px;
}
body.tv .shield.p1{
  max-width: 560px;
  min-height: 280px;
  transform: scale(1.04);
}

body.tv .bg-rank{
  font-size: 180px;
  opacity: .14;
}

body.tv .rank{ font-size: 28px; }
body.tv .name{ font-size: 24px; margin-top: 10px; }
body.tv .score{ font-size: 34px; margin-top: 12px; }
body.tv .score span{ font-size: 14px; }
body.tv .crown{ font-size: 34px; }

body.tv .row{
  grid-template-columns: 90px 1fr 120px;
  padding: 14px 16px;
  border-radius: 16px;
  font-size: 22px;
}
</style>
</head>

<body>
<div class="wrap">
  <header>
    <h1 class="main-title">‚≠ê Ranking Estrelas Guia</h1>
    <div id="pageTitle" class="sub-title">Estrelas Guia</div>

    <div class="tabbar">
      <button class="tab active" data-key="estrelas_guia">Estrelas Guia</button>
      <button class="tab" data-key="guiados_estrelas">Guiados / Estrelas</button>
      <button class="tab" data-key="guiados">Guiados</button>
      <button class="tab" id="toggleAuto">‚è∏ Pausar</button>
      <button class="tab" id="toggleTv">üì∫ Modo TV</button>
    </div>
  </header>

  <section class="board">
    <div class="content">
      <div class="panel">
        <div class="panel-title">üèÜ Top 3</div>
        <div class="top3" id="top3"></div>
      </div>

      <div class="panel">
        <div class="panel-title">üìã Demais posi√ß√µes</div>
        <div class="list" id="list"></div>
      </div>
    </div>
  </section>
</div>

<audio id="clickSound" preload="auto">
  <source src="https://assets.mixkit.co/sfx/preview/mixkit-game-click-1114.mp3">
</audio>

<script>
const DATA_FILE="dados.txt";
const tabKeys=["estrelas_guia","guiados_estrelas","guiados"];
const labels={
  estrelas_guia:"Estrelas Guia",
  guiados_estrelas:"Guiados / Estrelas",
  guiados:"Guiados"
};

let data={},active=0,auto=true;

const top3El=document.getElementById("top3");
const listEl=document.getElementById("list");
const pageTitle=document.getElementById("pageTitle");
const sound=document.getElementById("clickSound");
const toggleBtn=document.getElementById("toggleAuto");
const toggleTv=document.getElementById("toggleTv");

function parse(text){
  const out={estrelas_guia:[],guiados_estrelas:[],guiados:[]};
  const re=/(\d+\s*¬∫)\s+([A-Z√Ä-√ö0-9.\-\/ ]+?)\s+(\d+(?:[.,]\d+)?)\b/gmi;

  text.split(/\r?\n/).forEach(line=>{
    const upper=line.toUpperCase();
    if (
      upper.includes("ESTRELAS") ||
      upper.includes("GUIADOS/") ||
      upper.trim()==="GUIADOS" ||
      upper.includes("VENDEDOR") ||
      upper.includes("VIDAS")
    ) return;

    const m=[];
    let r;
    while((r=re.exec(line))!==null){
      const name=(r[2]||"").trim().replace(/\s{2,}/g," ");
      const score=Number(String(r[3]).replace(",","."));
      if(!name || !Number.isFinite(score)) continue;
      m.push({name,score});
    }
    if(m[0]) out.estrelas_guia.push(m[0]);
    if(m[1]) out.guiados_estrelas.push(m[1]);
    if(m[2]) out.guiados.push(m[2]);
  });

  Object.keys(out).forEach(k=>{
    out[k].sort((a,b)=>(b.score-a.score) || a.name.localeCompare(b.name,"pt-BR"));
  });
  return out;
}

function escapeHtml(s){
  return String(s).replace(/[&<>"']/g, m => ({
    "&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#039;"
  }[m]));
}

function clickSound(){
  try{
    sound.volume=.22;
    sound.currentTime=0;
    sound.play();
  }catch(e){}
}

function render(){
  const key=tabKeys[active];
  const items=data[key]||[];
  pageTitle.textContent=labels[key];

  const t=items.slice(0,3);
  const visual=[
    {i:t[0],p:1},
    {i:t[1],p:2},
    {i:t[2],p:3},
  ].filter(x=>x.i);

  top3El.innerHTML=visual.map(v=>`
    <div class="shield p${v.p} ${v.p===1?"champion":""}">
      <div class="bg-rank">${v.p}</div>
      <div class="front">
        ${v.p===1?'<div class="crown">üëë</div>':''}
        <div class="rank">${v.p}¬∫</div>
        <div class="name">${escapeHtml(v.i.name)}</div>
        <div class="score">${v.i.score}<span>vidas</span></div>
      </div>
    </div>
  `).join("");

  listEl.innerHTML=items.slice(3).map((i,idx)=>`
    <div class="row">
      <div class="pos">${idx+4}¬∫</div>
      <div class="who">${escapeHtml(i.name)}</div>
      <div class="val">${i.score}</div>
    </div>
  `).join("");
}

async function load(){
  const t=await fetch(DATA_FILE+"?v="+Date.now()).then(r=>r.text());
  data=parse(t);
  render();
}

document.querySelectorAll(".tab[data-key]").forEach((b,idx)=>{
  b.onclick=()=>{
    active=idx;
    document.querySelectorAll(".tab[data-key]").forEach(x=>x.classList.remove("active"));
    b.classList.add("active");
    clickSound();
    render();
  };
});

toggleBtn.onclick=()=>{
  auto=!auto;
  toggleBtn.textContent=auto?"‚è∏ Pausar":"‚ñ∂Ô∏è Continuar";
};

toggleTv.onclick=async ()=>{
  document.body.classList.toggle("tv");
  const on=document.body.classList.contains("tv");
  toggleTv.textContent=on?"üñ• Sair TV":"üì∫ Modo TV";
  if(on){
    try{ if(document.documentElement.requestFullscreen) await document.documentElement.requestFullscreen(); }catch(e){}
  }else{
    try{ if(document.fullscreenElement && document.exitFullscreen) await document.exitFullscreen(); }catch(e){}
  }
};

setInterval(()=>{
  if(!auto) return;
  active=(active+1)%tabKeys.length;
  document.querySelectorAll(".tab[data-key]")[active].click();
},30000);

load();
</script>
</body>
</html>

